import{r as u,u as D,j as e,B as b,I as N,M as z,c as K,S as H,A as V,T as w,v,a as O,b as L,C as q,D as G,Z,d as P,e as R,P as A,f as J,g as Q,h as T,i as U,k as W,p as X,l as Y}from"./vendor-CLWkeS7w.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))d(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&d(s)}).observe(document,{childList:!0,subtree:!0});function p(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerPolicy&&(o.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?o.credentials="include":t.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function d(t){if(t.ep)return;t.ep=!0;const o=p(t);fetch(t.href,o)}})();const $=()=>{const[a,n]=u.useState(!1),[p,d]=u.useState(""),[t,o]=D("drop-and-drag",{}),[s,r]=u.useState(""),[l,g]=u.useState([]),h=i=>r(i),C=Object.values(t).map(i=>({label:i.title,value:i.title})),k=()=>{if(!p){g([{key:1,text:"Название колонки отсутствует"}]);return}const i=Object.keys(t).find(j=>t[j].title===p),x={id:v(),name:s,color:"red",description:""};if(i){const j={...t[i],items:[...t[i].items,x]};o({...t,[i]:j})}else{const j=v(),y={title:p,items:s?[x]:[]};o({...t,[j]:y})}d(""),r(""),n(!1)};return e.jsxs("div",{className:"modal-add-task",children:[e.jsx(b,{size:"m",view:"primary",label:"Добавить задачу",width:"default",iconLeft:N,onClick:()=>n(!0)}),e.jsx(z,{className:K({p:"l"}),isOpen:a,hasOverlay:!0,onClickOutside:()=>n(!1),onEsc:()=>n(!1),children:e.jsxs("div",{className:"modal-add-task__container",children:[e.jsx(H,{onItemClose:()=>g([]),items:l,getItemMessage:i=>i.text,getItemAutoClose:()=>5}),e.jsx(V,{type:"text",placeholder:"Название колонки",value:p,maxLength:255,items:C,onChange:i=>d(i),getItemKey:i=>i.value}),e.jsx(w,{maxLength:255,onChange:i=>h(i),value:s,type:"text",placeholder:"Название карточки"}),e.jsx(b,{size:"m",view:"primary",label:"Добавить",width:"default",onClick:k})]})})]})},ee=()=>e.jsxs("div",{className:"navbar",children:[e.jsx("h1",{children:"КанДО"}),e.jsx($,{})]}),se=({item:a,columnId:n,isSidebarOpen:p,onClickOutside:d})=>{const[t,o]=u.useState(a.isClosed),[s,r]=u.useState(new Date(a.date??new Date)),[l,g]=u.useState(a.name),[h,C]=u.useState(a.description),[k,i]=u.useState(a.color),[x,j]=D("drop-and-drag",{}),[y,M]=u.useState({name:!1,description:!1});u.useEffect(()=>{a.date?o(new Date(a.date)<new Date):o(a.isClosed)},[a.date,a.isClosed]);const S=u.useCallback(c=>{const m={...x,[n]:{...x[n],items:x[n].items.map(_=>_.id===c.id?c:_)}};j(m)},[x,n,j]),f=u.useCallback((c,m)=>{c==="color"&&(!m||m==="")&&(m="green");const _={...a,[c]:m};switch(c){case"name":g(m);break;case"description":C(m);break;case"isClosed":o(m);break;case"date":r(m);break;case"color":i(m);break}S(_)},[a,S]),B=()=>{const c={...x,[n]:{...x[n],items:x[n].items.filter(m=>m.id!==a.id)}};j(c),d(!1)},F=u.useCallback(c=>()=>{M(m=>({...m,[c]:!m[c]}))},[]),I=c=>e.jsx(b,{label:y[c]?"Сохранить":"Редактировать",view:"clear",iconRight:y[c]?P:R,onlyIcon:!0,onClick:F(c)});return e.jsxs(e.Fragment,{children:[e.jsx("span",{style:{textDecoration:t?"line-through":"none"},children:l}),e.jsx(O,{hasOverlay:!1,size:"1/2",isOpen:p,onClickOutside:d,onEsc:d,children:e.jsxs(O.Content,{className:"card-sidebar__content",children:[e.jsx(b,{label:"Удалить карточку",view:"ghost",iconLeft:L,onClick:B}),e.jsxs("div",{className:"card-sidebar__input",children:[e.jsx(w,{onChange:c=>f("name",c),value:l,type:"text",maxLength:255,placeholder:"Заголовок",disabled:!y.name}),I("name")]}),e.jsx(q,{label:"Чекбокс",size:"m",view:"primary",checked:t,align:"center",disabled:!1,onChange:c=>f("isClosed",c.target.checked)}),e.jsxs("div",{className:"card-sidebar__input",children:[e.jsx(w,{onChange:c=>f("description",c),value:h,type:"textarea",cols:200,maxLength:1024,rows:5,placeholder:"Описание",disabled:!y.description}),I("description")]}),e.jsx(G,{label:"Дата завершения",value:s,onChange:c=>f("date",c)}),e.jsxs("div",{className:"card-sidebar__color",children:[e.jsx(b,{label:"Зеленый",style:{backgroundColor:"#55C776"},onClick:()=>f("color","#55C776")}),e.jsx(b,{label:"Желтый",style:{backgroundColor:"#F9D229"},onClick:()=>f("color","#F9D229")}),e.jsx(b,{label:"Красный",style:{backgroundColor:"#E62520"},onClick:()=>f("color","#E62520")}),e.jsx(Z,{color:k,onChange:c=>f("color",c)})]})]})})]})},te=({item:a,index:n,columnId:p})=>{const[d,t]=u.useState(!1),o=()=>{t(!1)};return e.jsx(A,{draggableId:a.id.toString(),index:n,children:s=>e.jsx("div",{ref:s.innerRef,...s.draggableProps,...s.dragHandleProps,className:"drop-and-drag__item",style:{...s.draggableProps.style},children:e.jsxs("div",{className:"drop-and-drag__item-content",onClick:()=>t(!0),children:[e.jsxs("div",{className:"drop-and-drag__item-main",children:[e.jsx(se,{isSidebarOpen:d,onClickOutside:o,columnId:p,item:a}),e.jsxs("div",{className:"drop-and-drag__item-info",children:[a.description&&e.jsx(J,{size:"s"}),a.date&&e.jsx("div",{className:"drop-and-drag__item-date",style:{backgroundColor:a.color},children:new Date(a.date).toLocaleDateString()})]})]}),e.jsx(Q,{})]})})})},ae=({columnId:a,column:n,updateColumnTitle:p,deleteColumn:d,addCard:t})=>{const[o,s]=u.useState(n.title),[r,l]=u.useState(!1),g=C=>s(C),h=()=>{r&&o!==n.title&&p(a,o),l(C=>!C)};return e.jsxs("div",{className:"drop-and-drag__column",children:[e.jsxs("div",{className:"drop-and-drag__column-header",children:[e.jsx("h2",{className:"drop-and-drag__column-title",children:r?e.jsx(w,{onChange:g,value:o,type:"text",placeholder:"Одна строчка"}):o}),e.jsxs("div",{className:"drop-and-drag__column-actions",children:[r?e.jsx(b,{label:"Сохранить",view:"clear",iconRight:P,onlyIcon:!0,onClick:h}):e.jsx(b,{label:"Редактировать",view:"clear",iconRight:R,onlyIcon:!0,onClick:h}),e.jsx(b,{label:"Удалить",view:"clear",iconRight:L,onlyIcon:!0,onClick:()=>d(a)}),e.jsx(b,{label:"Добавить карточку",view:"clear",iconRight:N,onlyIcon:!0,onClick:()=>t(a)})]})]}),e.jsx(T,{droppableId:a,children:(C,k)=>e.jsxs("div",{...C.droppableProps,ref:C.innerRef,className:"drop-and-drag__column-content",style:{background:k.isDraggingOver?"lightblue":""},children:[n.items.map((i,x)=>e.jsx(te,{columnId:a,item:i,index:x},i.id)),C.placeholder]})},a)]})},ne=(a,n,p)=>{if(!a.destination)return;const{source:d,destination:t,type:o}=a;if(o==="column"){const s=Array.from(Object.keys(n)),[r]=s.splice(d.index,1);s.splice(t.index,0,r);const l={};s.forEach((g,h)=>{l[g]=n[g]}),p(l);return}if(d.droppableId!==t.droppableId){const s=n[d.droppableId],r=n[t.droppableId],l=[...s.items],g=[...r.items],[h]=l.splice(d.index,1);g.splice(t.index,0,h),p({...n,[d.droppableId]:{...s,items:l},[t.droppableId]:{...r,items:g}})}else{const s=n[d.droppableId],r=[...s.items],[l]=r.splice(d.index,1);r.splice(t.index,0,l),p({...n,[d.droppableId]:{...s,items:r}})}},oe=()=>{const[a,n]=D("drop-and-drag",{}),p=(s,r)=>{n(l=>({...l,[s]:{...l[s],title:r}}))},d=s=>{n(r=>{const l={...r};return delete l[s],l})},t=s=>{const r={id:Date.now().toString(),name:"Новая карточка",color:"red",description:"",isClosed:!1};n(l=>({...l,[s]:{...l[s],items:[...l[s].items,r]}}))},o=()=>{const s=v(),r={title:"Новая колонка",items:[]};n(l=>({...l,[s]:r}))};return e.jsxs("div",{className:"drop-and-drag",children:[e.jsx(U,{onDragEnd:s=>ne(s,a,n),children:e.jsx(T,{droppableId:"all-columns",direction:"horizontal",type:"column",children:s=>e.jsxs("div",{...s.droppableProps,ref:s.innerRef,className:"drop-and-drag__column-container",children:[Object.entries(a).map(([r,l],g)=>e.jsx(A,{draggableId:r,index:g,children:h=>e.jsx("div",{className:"drop-and-drag__column-wrapper",ref:h.innerRef,...h.draggableProps,...h.dragHandleProps,children:e.jsx(ae,{columnId:r,column:l,updateColumnTitle:p,deleteColumn:d,addCard:t})})},r)),s.placeholder]})})}),e.jsx(b,{label:"Добавить новую колонку",view:"clear",onClick:o,iconLeft:N})]})},re=()=>e.jsx(oe,{});function le(){return e.jsxs(W,{preset:X,children:[e.jsx(ee,{}),e.jsx(re,{})]})}const E=document.getElementById("root");E&&Y.createRoot(E).render(e.jsx(le,{}));
